# Supabase Cleanup & Admin Panel Prep

## Objective
Remove unused Supabase dependencies and complex features before implementing a clean, simple Admin Panel with PostgreSQL.

## Current Situation

**Files with Supabase References:**
1. [middleware.ts](file:///Users/kemal/Development/aegontech.dev/frontend/middleware.ts) — Security headers with Supabase URL
2. [admin/portfolio/page.tsx](file:///Users/kemal/Development/aegontech.dev/frontend/app/%28marketing%29/admin/portfolio/page.tsx) — Admin UI for portfolio ingestion
3. [/api/blog/ingest/route.ts](file:///Users/kemal/Development/aegontech.dev/frontend/app/api/blog/ingest/route.ts) — Complex blog ingestion with storage
4. [/api/portfolio/ingest/route.ts](file:///Users/kemal/Development/aegontech.dev/frontend/app/api/portfolio/ingest/route.ts) — Complex portfolio ingestion
5. [lib/ingestion/media.ts](file:///Users/kemal/Development/aegontech.dev/frontend/lib/ingestion/media.ts) — Supabase Storage uploads
6. `lib/observability/audit.ts` — Audit logging
7. [lib/supabase/admin-session.ts](file:///Users/kemal/Development/aegontech.dev/frontend/lib/supabase/admin-session.ts) — Admin authentication
8. [lib/supabase/client.ts](file:///Users/kemal/Development/aegontech.dev/frontend/lib/supabase/client.ts) — Supabase client singleton
9. [package.json](file:///Users/kemal/Development/aegontech.dev/frontend/package.json) — `@supabase/supabase-js` dependency

**Key Issue:** These files implement advanced features (media uploads, ingestion APIs, audit logs) that are NOT required for the basic admin panel spec from product-plan.

##  Cleanup Strategy

### Option 1: Remove All Supabase (RECOMMENDED) ✅
**Rationale:** The product-plan admin panel spec only needs:
- Basic login/authentication
- Simple CRUD for portfolio items
- Simple CRUD for blog posts

It does NOT require:
- Media uploads to cloud storage
- Complex ingestion APIs
- Advanced audit logging
- Screenshot capture services

**Action Plan:**
1. Delete complex unused files:
   - [app/api/blog/ingest/route.ts](file:///Users/kemal/Development/aegontech.dev/frontend/app/api/blog/ingest/route.ts)
   - [app/api/portfolio/ingest/route.ts](file:///Users/kemal/Development/aegontech.dev/frontend/app/api/portfolio/ingest/route.ts)
   - `app/(marketing)/admin/portfolio/page.tsx`
   - `lib/ingestion/*`
   - `lib/observability/*`
   - `lib/supabase/*`

2. Simple authentication for admin panel:
   - Use environment variable for admin password
   - Store session in cookie/localStorage
   - Protect admin routes with middleware

3. Update [middleware.ts](file:///Users/kemal/Development/aegontech.dev/frontend/middleware.ts):
   - Remove Supabase URL references
   - Keep security headers

4. Remove `@supabase/supabase-js` from package.json

5. Implement simple admin panel:
   - Login page with password check
   - Dashboard showing stats
   - Portfolio CRUD (direct PostgreSQL)
   - Blog CRUD (direct PostgreSQL)

### Option 2: Keep Supabase for Storage Only
Convert Supabase client to use only PostgreSQL database, but this adds complexity for minimal benefit.

---

## Recommended Approach ✅

**Delete unused complex features** and implement a clean, simple admin panel:

### Files to DELETE:
- ❌ [/app/api/blog/ingest/route.ts](file:///Users/kemal/Development/aegontech.dev/frontend/app/api/blog/ingest/route.ts)
- ❌ [/app/api/portfolio/ingest/route.ts](file:///Users/kemal/Development/aegontech.dev/frontend/app/api/portfolio/ingest/route.ts)
- ❌ `/app/(marketing)/admin/portfolio/page.tsx`
- ❌ `/lib/ingestion/` (entire directory)
- ❌ `/lib/observability/` (entire directory)
- ❌ `/lib/supabase/` (entire directory)

### Files to UPDATE:
- ✏️ [middleware.ts](file:///Users/kemal/Development/aegontech.dev/frontend/middleware.ts) — Remove Supabase URL references
- ✏️ [package.json](file:///Users/kemal/Development/aegontech.dev/frontend/package.json) — Remove `@supabase/supabase-js`

### New Files to CREATE (Admin Panel):
- ✅ `/app/admin/login/page.tsx` — Simple login form
- ✅ `/app/admin/page.tsx` — Dashboard with stats
- ✅ `/app/admin/portfolio/page.tsx` — Portfolio CRUD
- ✅ `/app/admin/blog/page.tsx` — Blog CRUD
- ✅ `/lib/auth/simple-auth.ts` — Simple password-based auth
- ✅ [/middleware.ts](file:///Users/kemal/Development/aegontech.dev/frontend/middleware.ts) updates — Protect `/admin/*` routes

---

## Verification

1. Delete files and directories
2. Update middleware and package.json
3. Run `pnpm install` to remove unused dep
4. Verify app still builds
5. Implement admin panel with simple auth

**Result:** Clean codebase with only PostgreSQL, ready for simple admin panel implementation.
